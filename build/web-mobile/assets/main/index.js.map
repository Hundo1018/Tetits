{"version":3,"sources":["../file:/C:/ProgramData/cocos/editors/Creator/3.8.2/resources/resources/3d/engine/editor/assets/tools/file:/C:/ProgramData/cocos/editors/Creator/3.8.2/resources/resources/3d/engine/editor/assets/tools/debug-view-runtime-control.ts","../file:/C:/Projects/side/Tetits/Tetits/assets/Intents/file:/C:/Projects/side/Tetits/Tetits/assets/Intents/Intents.ts","../file:/C:/Projects/side/Tetits/Tetits/assets/Systems/file:/C:/Projects/side/Tetits/Tetits/assets/Systems/TetitsModel.ts","../file:/C:/Projects/side/Tetits/Tetits/assets/Systems/file:/C:/Projects/side/Tetits/Tetits/assets/Systems/TetitsView.ts","../file:/C:/Projects/side/Tetits/Tetits/assets/Entity/Tetromino/file:/C:/Projects/side/Tetits/Tetits/assets/Entity/Tetromino/Tetromino.ts"],"names":["ccclass","_decorator","property","DebugViewRuntimeControl","_dec","_dec2","Node","_dec3","_dec4","_class","_class2","_Component","_inheritsLoose","_this","_len","arguments","length","args","Array","_key","call","apply","concat","_initializerDefineProperty","_descriptor","_assertThisInitialized","_descriptor2","_descriptor3","_single","strSingle","strComposite","strMisc","compositeModeToggleList","singleModeToggleList","miscModeToggleList","textComponentList","labelComponentList","textContentList","hideButtonLabel","_currentColorIndex","strColor","color","Color","WHITE","BLACK","RED","GREEN","BLUE","_proto","prototype","start","canvas","node","parent","getComponent","Canvas","console","error","uiTransform","UITransform","halfScreenWidth","width","halfScreenHeight","height","x","y","miscNode","getChildByName","buttonNode","instantiate","name","titleNode","i","newLabel","EnableAllCompositeModeButton","setPosition","setScale","labelComponent","Label","string","overflow","currentRow","newNode","singleModeToggle","textComponent","getComponentInChildren","RichText","on","Toggle","EventType","TOGGLE","toggleSingleMode","Button","CLICK","enableAllCompositeMode","changeColorButton","changeTextColor","HideButton","hideUI","compositeModeToggle","toggleComponent","isChecked","toggleLightingWithAlbedo","toggleCSMColoration","toggleCompositeMode","isTextMatched","textUI","textDescription","tempText","String","findIndex","search","substr","toggle","debugView","director","root","singleMode","enableCompositeMode","lightingWithAlbedo","csmLayerColoration","button","activeValue","active","onLoad","update","deltaTime","Component","_applyDecoratedDescriptor","configurable","enumerable","writable","initializer","_RF","pop","IntentEnum","Intents","PlayerIntent","EventTarget","input","Input","KEY_DOWN","onKeyDown","event","keyCode","KeyCode","KEY_A","ARROW_LEFT","emit","MoveLeft","KEY_D","ARROW_RIGHT","MoveRight","KEY_S","ARROW_DOWN","SoftDrop","SPACE","HardDrop","SHIFT_LEFT","Hold","KEY_W","ARROW_UP","KEY_Q","RotateL","KEY_E","RotateR","onDestroy","off","UpdateEnum","TetitsModel","CCFloat","_dec5","Size","Updated","lockDelayTimer","lockDelayTimerMax","gravityCounter","_descriptor4","board","TetrominoBag","handlingTetromino","_this2","size","fill","map","shuffleBag","getNextTetromino","T","Tetromino","I","O","L","J","S","Z","push","j","Math","floor","random","_ref","intent","onMoveLeft","onMoveRight","onRotateL","onRotateR","onSoftDrop","onHardDrop","onHold","thisArgs","hardDrop","tryMove","Vec2","tryRotateR","tryRotateL","gravityPeriod","gravityDrop","BoardUpdate","tryPlaceTetromino","tetromino","_this3","isLegal","shape","position","forEach","row","cell","placeTetromino","Error","checkClearLines","GameOver","clearLines","every","splice","unshift","TetitsView","Prefab","ViewBoard","model","onBoardUpdate","undefined","tetrominoPrefab","setParent","thisArg","previewBoardArr","previewBoard","boardOutPut","innerboard","log","tryRotate","vec","nextPosition","clone","add","rotate","matrix","clockwise","n","temp","nextShape","inner","wallKick","wallKickData","boardWidth","boardHeight","newX","newY"],"mappings":"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","file":"all.js","sourcesContent":["import { Color, Canvas, UITransform, instantiate, math, Toggle, TextureCube, _decorator, Component, Button, labelAssembler, game, director, Node, Scene, renderer, CameraComponent, Label, ForwardPipeline, RichText } from 'cc';\r\nconst { ccclass, property } = _decorator;\r\n\r\n@ccclass('internal.DebugViewRuntimeControl')\r\nexport class DebugViewRuntimeControl extends Component {\r\n    @property(Node)\r\n    compositeModeToggle: Node | null = null;\r\n    @property(Node)\r\n    singleModeToggle: Node | null = null;\r\n    @property(Node)\r\n    EnableAllCompositeModeButton: Node | null = null;\r\n\t_single: number = 0;\r\n\r\n    private strSingle: string[] = [\r\n        'No Single Debug',\r\n        'Vertex Color',\r\n        'Vertex Normal',\r\n        'Vertex Tangent',\r\n        'World Position',\r\n        'Vertex Mirror',\r\n        'Face Side',\r\n        'UV0',\r\n        'UV1',\r\n        'UV Lightmap',\r\n        'Project Depth',\r\n        'Linear Depth',\r\n\r\n        'Fragment Normal',\r\n        'Fragment Tangent',\r\n        'Fragment Binormal',\r\n        'Base Color',\r\n        'Diffuse Color',\r\n        'Specular Color',\r\n        'Transparency',\r\n        'Metallic',\r\n        'Roughness',\r\n        'Specular Intensity',\r\n        'IOR',\r\n\r\n        'Direct Diffuse',\r\n        'Direct Specular',\r\n        'Direct All',\r\n        'Env Diffuse',\r\n        'Env Specular',\r\n        'Env All',\r\n        'Emissive',\r\n        'Light Map',\r\n        'Shadow',\r\n        'AO',\r\n\r\n        'Fresnel',\r\n        'Direct Transmit Diffuse',\r\n        'Direct Transmit Specular',\r\n        'Env Transmit Diffuse',\r\n        'Env Transmit Specular',\r\n        'Transmit All',\r\n        'Direct Internal Specular',\r\n        'Env Internal Specular',\r\n        'Internal All',\r\n\r\n        'Fog',\r\n    ];\r\n    private strComposite: string[] = [\r\n        'Direct Diffuse',\r\n        'Direct Specular',\r\n        'Env Diffuse',\r\n        'Env Specular',\r\n        'Emissive',\r\n        'Light Map',\r\n        'Shadow',\r\n        'AO',\r\n\r\n        'Normal Map',\r\n        'Fog',\r\n\r\n        'Tone Mapping',\r\n        'Gamma Correction',\r\n\r\n        'Fresnel',\r\n        'Transmit Diffuse',\r\n        'Transmit Specular',\r\n        'Internal Specular',\r\n        'TT',\r\n    ];\r\n    private strMisc: string[] = [\r\n        'CSM Layer Coloration',\r\n        'Lighting With Albedo',\r\n    ];\r\n\r\n    private compositeModeToggleList: Node[] = [];\r\n    private singleModeToggleList: Node[] = [];\r\n    private miscModeToggleList: Node[] = [];\r\n    private textComponentList: RichText[] = [];\r\n    private labelComponentList: Label[] = [];\r\n    private textContentList: string[] = [];\r\n    private hideButtonLabel: Label;\r\n    start() {\r\n        // get canvas resolution\r\n        const canvas = this.node.parent.getComponent(Canvas);\r\n        if (!canvas) {\r\n            console.error('debug-view-runtime-control should be child of Canvas');\r\n            return;\r\n        }\r\n\r\n        const uiTransform = this.node.parent.getComponent(UITransform);\r\n        const halfScreenWidth = uiTransform.width * 0.5;\r\n        const halfScreenHeight = uiTransform.height * 0.5;\r\n\r\n        let x = -halfScreenWidth + halfScreenWidth * 0.1, y = halfScreenHeight - halfScreenHeight * 0.1;\r\n        const width = 200, height = 20;\r\n\r\n        // new nodes\r\n        const miscNode = this.node.getChildByName('MiscMode');\r\n        const buttonNode = instantiate(miscNode);\r\n        buttonNode.parent = this.node;\r\n        buttonNode.name = 'Buttons';\r\n        const titleNode = instantiate(miscNode);\r\n        titleNode.parent = this.node;\r\n        titleNode.name = 'Titles';\r\n\r\n        // title\r\n        for (let i = 0; i < 2; i++) {\r\n            const newLabel = instantiate(this.EnableAllCompositeModeButton.getChildByName('Label'));\r\n            newLabel.setPosition(x + (i > 0 ? 50 + width * 2 : 150), y, 0.0);\r\n            newLabel.setScale(0.75, 0.75, 0.75);\r\n            newLabel.parent = titleNode;\r\n            const labelComponent = newLabel.getComponent(Label);\r\n            labelComponent.string = i ? '----------Composite Mode----------' : '----------Single Mode----------';\r\n            labelComponent.color = Color.WHITE;\r\n            labelComponent.overflow = 0;\r\n            this.labelComponentList[this.labelComponentList.length] = labelComponent;\r\n        }\r\n\r\n        y -= height;\r\n        // single\r\n        let currentRow = 0;\r\n        for (let i = 0; i < this.strSingle.length; i++, currentRow++) {\r\n            if (i === this.strSingle.length >> 1) {\r\n                x += width;\r\n                currentRow = 0;\r\n            }\r\n            const newNode = i ? instantiate(this.singleModeToggle) : this.singleModeToggle;\r\n            newNode.setPosition(x, y - height * currentRow, 0.0);\r\n            newNode.setScale(0.5, 0.5, 0.5);\r\n            newNode.parent = this.singleModeToggle.parent;\r\n\r\n            const textComponent = newNode.getComponentInChildren(RichText);\r\n            textComponent.string = this.strSingle[i];\r\n            this.textComponentList[this.textComponentList.length] = textComponent;\r\n            this.textContentList[this.textContentList.length] = textComponent.string;\r\n\r\n            newNode.on(Toggle.EventType.TOGGLE, this.toggleSingleMode, this);\r\n\r\n            this.singleModeToggleList[i] = newNode;\r\n        }\r\n\r\n        x += width;\r\n        // buttons\r\n        this.EnableAllCompositeModeButton.setPosition(x + 15, y, 0.0);\r\n        this.EnableAllCompositeModeButton.setScale(0.5, 0.5, 0.5);\r\n        this.EnableAllCompositeModeButton.on(Button.EventType.CLICK, this.enableAllCompositeMode, this);\r\n        this.EnableAllCompositeModeButton.parent = buttonNode;\r\n        let labelComponent = this.EnableAllCompositeModeButton.getComponentInChildren(Label);\r\n        this.labelComponentList[this.labelComponentList.length] = labelComponent;\r\n\r\n        const changeColorButton = instantiate(this.EnableAllCompositeModeButton);\r\n        changeColorButton.setPosition(x + 90, y, 0.0);\r\n        changeColorButton.setScale(0.5, 0.5, 0.5);\r\n        changeColorButton.on(Button.EventType.CLICK, this.changeTextColor, this);\r\n        changeColorButton.parent = buttonNode;\r\n        labelComponent = changeColorButton.getComponentInChildren(Label);\r\n        labelComponent.string = 'TextColor';\r\n        this.labelComponentList[this.labelComponentList.length] = labelComponent;\r\n\r\n        const HideButton = instantiate(this.EnableAllCompositeModeButton);\r\n        HideButton.setPosition(x + 200, y, 0.0);\r\n        HideButton.setScale(0.5, 0.5, 0.5);\r\n        HideButton.on(Button.EventType.CLICK, this.hideUI, this);\r\n        HideButton.parent = this.node.parent;\r\n        labelComponent = HideButton.getComponentInChildren(Label);\r\n        labelComponent.string = 'Hide UI';\r\n        this.labelComponentList[this.labelComponentList.length] = labelComponent;\r\n        this.hideButtonLabel = labelComponent;\r\n\r\n        // misc\r\n        y -= 40;\r\n        for (let i = 0; i < this.strMisc.length; i++) {\r\n            const newNode = instantiate(this.compositeModeToggle);\r\n            newNode.setPosition(x, y - height * i, 0.0);\r\n            newNode.setScale(0.5, 0.5, 0.5);\r\n            newNode.parent = miscNode;\r\n\r\n            const textComponent = newNode.getComponentInChildren(RichText);\r\n            textComponent.string = this.strMisc[i];\r\n            this.textComponentList[this.textComponentList.length] = textComponent;\r\n            this.textContentList[this.textContentList.length] = textComponent.string;\r\n\r\n            const toggleComponent = newNode.getComponent(Toggle);\r\n            toggleComponent.isChecked = i ? true : false;\r\n            newNode.on(Toggle.EventType.TOGGLE, i ? this.toggleLightingWithAlbedo : this.toggleCSMColoration, this);\r\n            this.miscModeToggleList[i] = newNode;\r\n        }\r\n\r\n        // composite\r\n        y -= 150;\r\n        for (let i = 0; i < this.strComposite.length; i++) {\r\n            const newNode = i ? instantiate(this.compositeModeToggle) : this.compositeModeToggle;\r\n            newNode.setPosition(x, y - height * i, 0.0);\r\n            newNode.setScale(0.5, 0.5, 0.5);\r\n            newNode.parent = this.compositeModeToggle.parent;\r\n\r\n            const textComponent = newNode.getComponentInChildren(RichText);\r\n            textComponent.string = this.strComposite[i];\r\n            this.textComponentList[this.textComponentList.length] = textComponent;\r\n            this.textContentList[this.textContentList.length] = textComponent.string;\r\n\r\n            newNode.on(Toggle.EventType.TOGGLE, this.toggleCompositeMode, this);\r\n\r\n            this.compositeModeToggleList[i] = newNode;\r\n        }\r\n    }\r\n\r\n    isTextMatched(textUI, textDescription) : boolean {\r\n        let tempText = new String(textUI);\r\n        const findIndex = tempText.search('>');\r\n        if (findIndex === -1) {\r\n            return textUI === textDescription;\r\n        } else {\r\n            tempText = tempText.substr(findIndex + 1);\r\n            tempText = tempText.substr(0, tempText.search('<'));\r\n            return tempText === textDescription;\r\n        }\r\n    }\r\n    toggleSingleMode(toggle: Toggle) {\r\n        const debugView = director.root!.debugView;\r\n        const textComponent = toggle.getComponentInChildren(RichText);\r\n        for (let i = 0; i < this.strSingle.length; i++) {\r\n            if (this.isTextMatched(textComponent.string, this.strSingle[i])) {\r\n                debugView.singleMode = i;\r\n            }\r\n        }\r\n    }\r\n    toggleCompositeMode(toggle: Toggle) {\r\n        const debugView = director.root!.debugView;\r\n        const textComponent = toggle.getComponentInChildren(RichText);\r\n        for (let i = 0; i < this.strComposite.length; i++) {\r\n            if (this.isTextMatched(textComponent.string, this.strComposite[i])) {\r\n                debugView.enableCompositeMode(i, toggle.isChecked);\r\n            }\r\n        }\r\n    }\r\n    toggleLightingWithAlbedo(toggle: Toggle) {\r\n        const debugView = director.root!.debugView;\r\n        debugView.lightingWithAlbedo = toggle.isChecked;\r\n    }\r\n    toggleCSMColoration(toggle: Toggle) {\r\n        const debugView = director.root!.debugView;\r\n        debugView.csmLayerColoration = toggle.isChecked;\r\n    }\r\n    enableAllCompositeMode(button: Button) {\r\n        const debugView = director.root!.debugView;\r\n        debugView.enableAllCompositeMode(true);\r\n        for (let i = 0; i < this.compositeModeToggleList.length; i++) {\r\n            const toggleComponent = this.compositeModeToggleList[i].getComponent(Toggle);\r\n            toggleComponent.isChecked = true;\r\n        }\r\n\r\n        let toggleComponent = this.miscModeToggleList[0].getComponent(Toggle);\r\n        toggleComponent.isChecked = false;\r\n        debugView.csmLayerColoration = false;\r\n        toggleComponent = this.miscModeToggleList[1].getComponent(Toggle);\r\n        toggleComponent.isChecked = true;\r\n        debugView.lightingWithAlbedo = true;\r\n    }\r\n    hideUI(button: Button) {\r\n        const titleNode = this.node.getChildByName('Titles');\r\n        const activeValue = !titleNode.active;\r\n        this.singleModeToggleList[0].parent.active = activeValue;\r\n        this.miscModeToggleList[0].parent.active = activeValue;\r\n        this.compositeModeToggleList[0].parent.active = activeValue;\r\n        this.EnableAllCompositeModeButton.parent.active = activeValue;\r\n        titleNode.active = activeValue;\r\n        this.hideButtonLabel.string = activeValue ? 'Hide UI' : 'Show UI';\r\n    }\r\n\r\n    private _currentColorIndex = 0;\r\n    private strColor: string[] = [\r\n        '<color=#ffffff>',\r\n        '<color=#000000>',\r\n        '<color=#ff0000>',\r\n        '<color=#00ff00>',\r\n        '<color=#0000ff>',\r\n    ];\r\n    private color: Color[] = [\r\n        Color.WHITE,\r\n        Color.BLACK,\r\n        Color.RED,\r\n        Color.GREEN,\r\n        Color.BLUE,\r\n    ];\r\n    changeTextColor(button: Button) {\r\n        this._currentColorIndex++;\r\n        if (this._currentColorIndex >= this.strColor.length) {\r\n            this._currentColorIndex = 0;\r\n        }\r\n        for (let i = 0; i < this.textComponentList.length; i++) {\r\n            this.textComponentList[i].string = this.strColor[this._currentColorIndex] + this.textContentList[i] + '</color>';\r\n        }\r\n        for (let i = 0; i < this.labelComponentList.length; i++) {\r\n            this.labelComponentList[i].color = this.color[this._currentColorIndex];\r\n        }\r\n    }\r\n\r\n    onLoad() {\r\n    }\r\n    update(deltaTime: number) {\r\n    }\r\n}\r\n","import { _decorator, Component, Event, EventKeyboard, EventTarget, EventTouch, input, Input, KeyCode, Node } from 'cc';\nconst { ccclass, property } = _decorator;\n\nexport enum IntentEnum {\n    RotateL,\n    RotateR,\n    MoveLeft,\n    MoveRight,\n    SoftDrop,\n    HardDrop,\n    Hold,\n    Update,\n}\n@ccclass('Intents')\nexport class Intents extends Component {\n    public PlayerIntent: EventTarget = new EventTarget();\n\n    onLoad(): void {\n        input.on(Input.EventType.KEY_DOWN, this.onKeyDown, this);\n    }\n    onKeyDown(event: EventKeyboard) {\n        switch (event.keyCode) {\n            case KeyCode.KEY_A:\n            case KeyCode.ARROW_LEFT:\n                this.PlayerIntent.emit(IntentEnum.MoveLeft);\n                break;\n            case KeyCode.KEY_D:\n            case KeyCode.ARROW_RIGHT:\n                this.PlayerIntent.emit(IntentEnum.MoveRight);\n                break;\n            case KeyCode.KEY_S:\n            case KeyCode.ARROW_DOWN:\n                this.PlayerIntent.emit(IntentEnum.SoftDrop);\n                break;\n            case KeyCode.SPACE:\n                this.PlayerIntent.emit(IntentEnum.HardDrop);\n                break;\n            case KeyCode.SHIFT_LEFT:\n                this.PlayerIntent.emit(IntentEnum.Hold);\n                break;\n            case KeyCode.KEY_W:\n            case KeyCode.ARROW_UP:\n            case KeyCode.KEY_Q:\n                this.PlayerIntent.emit(IntentEnum.RotateL);\n                break;\n            case KeyCode.KEY_E:\n                this.PlayerIntent.emit(IntentEnum.RotateR);\n                break;\n        }\n    }\n    onDestroy(): void {\n        input.off(Input.EventType.KEY_DOWN, this.onKeyDown, this);\n    }\n}\n\n\n","import { _decorator, Canvas, CCFloat, CCInteger, Component, debug, director, EventInfo, instantiate, log, math, Node, Prefab, Size, Sprite, v3, Vec2, Vec3, EventTarget, Quat } from 'cc';\nimport { IntentEnum, Intents } from '../Intents/Intents';\nimport { Tetromino } from '../Entity/Tetromino/Tetromino';\nconst { ccclass, property } = _decorator;\n\nexport enum UpdateEnum {\n    BoardUpdate,\n    GameOver,\n}\n\n@ccclass('TetitsModel')\nexport class TetitsModel extends Component {\n    public Updated: EventTarget = new EventTarget();\n\n    @property(Intents)\n    private intent: Intents;\n\n    //LockDelay的計時器\n    @property(CCFloat)\n    public lockDelayTimerMax: number = 1;\n    public lockDelayTimer: number = this.lockDelayTimerMax;\n\n    //下落的週期，單位為秒\n    @property(CCFloat)\n    public gravityPeriod: number = 1;\n    private gravityCounter: number = 0;\n\n    //遊戲棋盤大小\n    @property(Size)\n    public size: Size = new Size(10, 20);\n    //邏輯相關\n    //遊戲棋盤放置已成定局的盤面\n    board: number[][] = [];\n\n    //接下來的方塊\n    TetrominoBag: Tetromino[] = [];\n\n\n    //目前正在操作的方塊\n    handlingTetromino: Tetromino;\n\n    onLoad(): void {\n        this.lockDelayTimer = this.lockDelayTimerMax;\n        this.board = new Array(this.size.height).fill(0).map(() => new Array(this.size.width).fill(0));\n        \n\n        this.shuffleBag();\n        this.handlingTetromino = this.getNextTetromino();\n    }\n\n    shuffleBag() {\n        let T = new Tetromino([\n            [0, 1, 0, ],\n            [1, 1, 1, ],\n            [0, 0, 0, ],], this.board);\n        let I = new Tetromino([\n            [0, 0, 0, 0,],\n            [1, 1, 1, 1,],\n            [0, 0, 0, 0,],\n            [0, 0, 0, 0,],] ,this.board);\n        let O = new Tetromino([\n            [ 1, 1, ],\n            [ 1, 1, ],],  this.board);\n        let L = new Tetromino([\n            [0, 0, 0, ],\n            [1, 1, 1, ],\n            [1, 0, 0, ],],  this.board);\n        let J = new Tetromino([\n            [ 0, 0, 0,],\n            [ 1, 1, 1,],\n            [ 0, 0, 1,],],  this.board);\n        let S = new Tetromino([\n            [0, 0, 0, ],\n            [0, 1, 1, ],\n            [1, 1, 0, ],],  this.board);\n        let Z = new Tetromino([\n            [0, 0, 0, ],\n            [1, 1, 0, ],\n            [0, 1, 1, ],], this.board);\n        this.TetrominoBag.push(T);\n        this.TetrominoBag.push(I);\n        this.TetrominoBag.push(O);\n        this.TetrominoBag.push(L);\n        this.TetrominoBag.push(J);\n        this.TetrominoBag.push(S);\n        this.TetrominoBag.push(Z);\n        for (let i = this.TetrominoBag.length - 1; i > 0; i--) {\n            const j = Math.floor(Math.random() * (i + 1));\n            [this.TetrominoBag[i], this.TetrominoBag[j]] = [this.TetrominoBag[j], this.TetrominoBag[i]];\n        }\n    }\n\n    start() {\n        this.intent.PlayerIntent.on(IntentEnum.MoveLeft, this.onMoveLeft, this);\n        this.intent.PlayerIntent.on(IntentEnum.MoveRight, this.onMoveRight, this);\n        this.intent.PlayerIntent.on(IntentEnum.RotateL, this.onRotateL, this);\n        this.intent.PlayerIntent.on(IntentEnum.RotateR, this.onRotateR, this);\n        this.intent.PlayerIntent.on(IntentEnum.SoftDrop, this.onSoftDrop, this);\n        this.intent.PlayerIntent.on(IntentEnum.HardDrop, this.onHardDrop, this);\n        this.intent.PlayerIntent.on(IntentEnum.Hold, this.onHold, this);\n    }\n    onHold(Hold: IntentEnum, onHold: any, thisArgs: this) {\n    }\n    onHardDrop(HardDrop: IntentEnum, onHardDrop: any, thisArgs: this) {\n        this.handlingTetromino.hardDrop();\n    }\n    onSoftDrop(SoftDrop: IntentEnum, onSoftDrop: any, thisArgs: this) {\n        this.handlingTetromino.tryMove(new Vec2(0, 1));\n    }\n    onRotateR(RotateR: IntentEnum, onRotateR: any, thisArgs: this) {\n        this.handlingTetromino.tryRotateR();\n    }\n    onRotateL(RotateL: IntentEnum, onRotateL: any, thisArgs: this) {\n        this.handlingTetromino.tryRotateL();\n    }\n    onMoveRight(MoveRight: IntentEnum, onMoveRight: any, thisArgs: this) {\n        this.handlingTetromino.tryMove(new Vec2(1, 0));\n    }\n    onMoveLeft(MoveLeft: IntentEnum, onMoveLeft: any, thisArgs: this) {\n        this.handlingTetromino.tryMove(new Vec2(-1, 0));\n    }\n\n\n\n    update(deltaTime: number) {\n        //依照時間更新\n        this.gravityCounter += deltaTime;\n        if (this.gravityCounter >= this.gravityPeriod) {\n            this.gravityCounter = 0;\n            this.gravityDrop();\n        }\n        this.Updated.emit(UpdateEnum.BoardUpdate, this.board, this.handlingTetromino);\n    }\n\n\n\n\n\n    //檢查是否可以放置到棋盤上\n    //如果可以放置，則放置並回傳true，否則回傳false\n    private tryPlaceTetromino(tetromino: Tetromino): boolean {\n        if (tetromino.isLegal(tetromino.shape, tetromino.position)) {\n            tetromino.shape.forEach((row, y) => {\n                row.forEach((cell, x) => {\n                    if (cell != 0) {\n                        this.board[tetromino.position.y + y][tetromino.position.x + x] = cell;\n                    }\n                }, this);\n            });\n            return true;\n        }\n        return false;\n    }\n\n\n    //將方塊放置在棋盤上\n    private placeTetromino(tetromino: Tetromino): void {\n        if (!this.tryPlaceTetromino(tetromino)) {\n            throw new Error(\"Cannot place tetromino\");\n        }\n    }\n\n    //重力下落，如果無法下落則放置，在放置前會檢查是否有LockDelay\n    private gravityDrop(): void {\n        //如果無法下落，則放置\n        if (!this.handlingTetromino.tryMove(new Vec2(0, 1))) {\n            if (this.lockDelayTimer <= 0) {\n                this.placeTetromino(this.handlingTetromino);\n                this.checkClearLines();\n                //檢查遊戲是否結束\n                if (this.handlingTetromino.position.y == 0 &&\n                    !this.handlingTetromino.isLegal(this.handlingTetromino.shape, this.handlingTetromino.position)) {\n                    this.Updated.emit(UpdateEnum.GameOver);\n                }\n                \n                this.lockDelayTimer = this.lockDelayTimerMax;\n                this.handlingTetromino = this.getNextTetromino();\n            } else {\n                this.lockDelayTimer--;\n            }\n        }\n        else {\n            this.lockDelayTimer = this.lockDelayTimerMax;\n        }\n    }\n\n    //在新放置的方塊區域，檢查是否有滿行，並消除，上方的方塊下降，並回傳消除的行數\n    private checkClearLines(): number {\n        let clearLines = 0;\n        for (let y = 0; y < this.board.length; y++) {\n            if (this.board[y].every(cell => cell != 0)) {\n                this.board.splice(y, 1);\n                this.board.unshift(new Array(this.board[0].length).fill(0));\n                clearLines++;\n            }\n        }\n        return clearLines;\n    }\n\n    //得到下一個方塊\n    private getNextTetromino(): Tetromino {\n        if (this.TetrominoBag.length == 0) {\n            this.shuffleBag();\n        }\n        return this.TetrominoBag.pop();\n    }\n}\n\n\nexport { Tetromino };\n\n","import { _decorator, Component, instantiate, Node, Prefab } from 'cc';\nimport { TetitsModel, UpdateEnum,Tetromino } from './TetitsModel';\nconst { ccclass, property } = _decorator;\n\n@ccclass('TetitsView')\nexport class TetitsView extends Component {\n\n    @property(Prefab)\n    tetrominoPrefab: Prefab = null!;\n\n    @property(TetitsModel)\n    model: TetitsModel = null!;\n    \n    ViewBoard: Node[][] = [];\n\n    start() {\n        this.model.Updated.on(UpdateEnum.BoardUpdate,this.onBoardUpdate, this);\n\n        for (let y = 0; y < this.model.size.height; y++) {\n            for (let x = 0; x < this.model.size.width; x++) {\n                if (this.ViewBoard[y] == undefined) {\n                    this.ViewBoard[y] = [];\n                }\n                if (this.ViewBoard[y][x] == undefined) {\n                    this.ViewBoard[y][x] = instantiate(this.tetrominoPrefab);\n                    this.ViewBoard[y][x].setParent(this.node);\n                    this.ViewBoard[y][x].setPosition(x * 32, -y * 32);\n                    this.ViewBoard[y][x].active = false;\n                }\n            }\n        }\n    }\n\n    update(deltaTime: number) {\n\n    }\n    private onBoardUpdate(board: number[][], handlingTetromino: Tetromino,  thisArg: this): void {\n        \n        let previewBoardArr = this.previewBoard(board, handlingTetromino);\n        for (let y = 0; y < previewBoardArr.length; y++) {\n            for (let x = 0; x < previewBoardArr[y].length; x++) {\n                if (previewBoardArr[y][x] == 0) {\n                    this.ViewBoard[y][x].active = false;\n                } else {\n                    this.ViewBoard[y][x].active = true;\n                }\n            }\n        }\n    }\n\n    private previewBoard(board:number[][], handlingTetromino:Tetromino):number[][] {\n        let boardOutPut: String = \"\";\n        let previewBoard = board.map(innerboard => [...innerboard]);\n        handlingTetromino.shape.forEach((row, y) => {\n            row.forEach((cell, x) => {\n                if (cell != 0) {\n                    previewBoard\n                    [handlingTetromino.position.y + y]\n                    [handlingTetromino.position.x + x] = cell;\n                }\n            }, this);\n        });\n        console.log(boardOutPut);\n        return previewBoard;\n    }\n\n    protected onDestroy(): void {\n        this.model.Updated.off(UpdateEnum.BoardUpdate,this.onBoardUpdate,this);\n    }\n}\n\n\n","import { Vec2 } from \"cc\";\n\nexport class Tetromino {\n    //4x4的方塊，0為空\n    public shape: number[][] = []\n    //方塊的位置，LeftTop為(0,0)\n    public position: Vec2 = new Vec2(0, 0);\n    //方塊的盤面，0為空\n    private board: number[][] = [];\n\n\n    public constructor(shape: number[][], board: number[][]) {\n\n        if (board.length < 10 || board[0].length < 10) {\n            throw new Error(\"Board must be at least 10x10\");\n        }\n        this.shape = shape;\n        this.board = board;\n    }\n\n\n\n    //嘗試旋轉方塊，如果成功則旋轉並回傳true，否則回傳false\n    public tryRotateL(): boolean {\n        return this.tryRotate(false);\n    }\n\n    //嘗試旋轉方塊，如果成功則旋轉並回傳true，否則回傳false\n    public tryRotateR(): boolean {\n        return this.tryRotate(true);\n    }\n\n    //嘗試移動方塊，如果成功則移動並回傳true，否則回傳false\n    public tryMove(vec: Vec2): boolean {\n        let nextPosition = this.position.clone().add(vec);\n        if (this.isLegal(this.shape, nextPosition)) {\n            this.position = nextPosition;\n            return true;\n        }\n        return false;\n    }\n\n    private rotate(matrix: number[][],clockwise:boolean): void {\n        const n: number = matrix.length;\n        let width: number = n - 1;\n    \n        for (let i = 0; i < Math.floor(n / 2); i++) {\n            for (let j = i; j < i + width; j++) {\n                if (clockwise) {\n                    const temp: number = matrix[i][j];\n                    matrix[i][j] = matrix[n - j - 1][i];\n                    matrix[n - j - 1][i] = matrix[n - i - 1][n - j - 1];\n                    matrix[n - i - 1][n - j - 1] = matrix[j][n - i - 1];\n                    matrix[j][n - i - 1] = temp;\n                } else {\n                    const temp: number = matrix[i][j];\n                    matrix[i][j] = matrix[j][n - i - 1];\n                    matrix[j][n - i - 1] = matrix[n - i - 1][n - j - 1];\n                    matrix[n - i - 1][n - j - 1] = matrix[n - j - 1][i];\n                    matrix[n - j - 1][i] = temp;\n                }\n            }\n            width -= 2;\n        }\n    }\n\n    //嘗試旋轉方塊，如果失敗則進行WallKick檢查，如果還是失敗則不旋轉\n    private tryRotate(clockwise: boolean): boolean {\n\n        let nextShape = this.shape.map(inner => [...inner]);\n        this.rotate(nextShape,clockwise);\n        if (this.isLegal(nextShape, this.position)) {\n            this.shape = nextShape;\n            return true;\n        } else {\n            if (this.wallKick(nextShape)) {\n                return true;\n            }\n        }\n        return false;\n    }\n\n\n\n    //WallKick檢查，如果可以則進行WallKick，規則為最寬鬆且最符合直覺的規則\n    private wallKick(nextShape: number[][]): boolean {\n        let wallKickData: Vec2[][] = [\n            [new Vec2(0, 0), new Vec2(-1, 0), new Vec2(-1, 1), new Vec2(0, -2), new Vec2(-1, -2)],\n            [new Vec2(0, 0), new Vec2(1, 0), new Vec2(1, -1), new Vec2(0, 2), new Vec2(1, 2)],\n            [new Vec2(0, 0), new Vec2(1, 0), new Vec2(1, 1), new Vec2(0, -2), new Vec2(1, -2)],\n            [new Vec2(0, 0), new Vec2(-1, 0), new Vec2(-1, -1), new Vec2(0, 2), new Vec2(-1, 2)],\n        ];\n        for (let i = 0; i < wallKickData.length; i++) {\n            for (let j = 0; j < wallKickData[i].length; j++) {\n                let wallKick = wallKickData[i][j];\n                let nextPosition = this.position.clone().add(wallKick);\n                if (this.isLegal(nextShape, nextPosition)) {\n                    this.position = nextPosition;\n                    this.shape = nextShape;\n                    return true;\n                }\n            }\n        }\n        return false;\n    }\n\n\n    //檢查移動是否合法(沒有與其他方塊重疊，沒有超出邊界)\n    public isLegal(shape: number[][], position: Vec2): boolean {\n        const boardWidth = this.board[0].length;\n        const boardHeight = this.board.length;\n\n        for (let y = 0; y < shape.length; y++) {\n            for (let x = 0; x < shape[y].length; x++) {\n                if (shape[y][x] == 0)\n                    continue;\n                const newX = position.x + x;\n                const newY = position.y + y;\n                if (newX < 0 || newX >= boardWidth || newY < 0 || newY >= boardHeight)\n                    return false;\n                if (this.board[newY][newX] !== 0)\n                    return false;\n            }\n        }\n\n        return true;\n    }\n\n    //快速掉落方塊\n    public hardDrop(): void {\n        while (this.tryMove(new Vec2(0, 1))) {\n        }\n    }\n}"]}